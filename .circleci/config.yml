# Javascript Node CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-javascript/ for more details
#
version: 2
jobs:
  # deploy:
  #  docker:
  #    - image: circleci/buildpack-deps:jessie

  #steps:
  # - checkout
  #- run:
  #   name: install devspace
  #  command: |
  #curl -s -L "https://github.com/devspace-cloud/devspace/releases/latest" |\
  #sed -nE 's!.*"([^"]*devspace-linux-amd64)".*!https://github.com\1!p' | xargs -n 1 curl -L -o devspace && chmod +x devspace;
  #sudo mv devspace /usr/local/bin;
  build:
    docker:
      # specify the version you desire here
      - image: circleci/buildpack-deps:jessie

    steps:
      - checkout
      - setup_remote_docker

      - run:
          name: build
          command: docker-compose build
    - run:
         name: test
        command: docker-compose up --abort-on-container-exit
    #   - run:
    #      name: Waiting for Postgres to be ready
    #     command: |
    #      for i in `seq 1 10`;
    #     do
    #      nc -z localhost 5432 && echo Success && exit 0
    #     echo -n .
    #    sleep 1
    #  done
    #  echo Failed waiting for Postgres && exit 1
